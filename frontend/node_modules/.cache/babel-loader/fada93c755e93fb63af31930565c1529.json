{"ast":null,"code":"var _jsxFileName = \"D:\\\\ATTEMPT\\\\amazona\\\\frontend\\\\src\\\\screens\\\\SearchScreen.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useReducer, useState } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { getError } from '../utils';\nimport { Helmet } from 'react-helmet-async';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Rating from '../components/Rating';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nimport Button from 'react-bootstrap/Button';\nimport Event from '../components/Event';\nimport LinkContainer from 'react-router-bootstrap/LinkContainer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'FETCH_REQUEST':\n      return { ...state,\n        loading: true\n      };\n\n    case 'FETCH_SUCCESS':\n      return { ...state,\n        events: action.payload.events,\n        page: action.payload.page,\n        pages: action.payload.pages,\n        countEvents: action.payload.countEvents,\n        loading: false\n      };\n\n    case 'FETCH_FAIL':\n      return { ...state,\n        loading: false,\n        error: action.payload\n      };\n\n    default:\n      return state;\n  }\n};\n\nconst prices = [{\n  name: '$1 to $50',\n  value: '1-50'\n}, {\n  name: '$51 to $200',\n  value: '51-200'\n}, {\n  name: '$201 to $1000',\n  value: '201-1000'\n}];\nexport const ratings = [{\n  name: '4stars & up',\n  rating: 4\n}, {\n  name: '3stars & up',\n  rating: 3\n}, {\n  name: '2stars & up',\n  rating: 2\n}, {\n  name: '1stars & up',\n  rating: 1\n}];\nexport default function SearchScreen() {\n  _s();\n\n  const navigate = useNavigate();\n  const {\n    search\n  } = useLocation();\n  const sp = new URLSearchParams(search); // /search?category=Shirts\n\n  const category = sp.get('category') || 'all';\n  const query = sp.get('query') || 'all';\n  const price = sp.get('price') || 'all';\n  const rating = sp.get('rating') || 'all';\n  const order = sp.get('order') || 'newest';\n  const page = sp.get('page') || 1;\n  const [{\n    loading,\n    error,\n    events,\n    pages,\n    countEvents\n  }, dispatch] = useReducer(reducer, {\n    loading: true,\n    error: ''\n  });\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const {\n          data\n        } = await axios.get(`/api/events/search?page=${page}&query=${query}&category=${category}&price=${price}&rating=${rating}&order=${order}`);\n        dispatch({\n          type: 'FETCH_SUCCESS',\n          payload: data\n        });\n      } catch (err) {\n        dispatch({\n          type: 'FETCH_FAIL',\n          payload: getError(error)\n        });\n      }\n    };\n\n    fetchData();\n  }, [category, error, order, page, price, query, rating]);\n  const [categories, setCategories] = useState([]);\n  useEffect(() => {\n    const fetchCategories = async () => {\n      try {\n        const {\n          data\n        } = await axios.get(`/api/events/categories`);\n        setCategories(data);\n      } catch (err) {\n        toast.error(getError(err));\n      }\n    };\n\n    fetchCategories();\n  }, [dispatch]);\n\n  const getFilterUrl = filter => {\n    const filterPage = filter.page || page;\n    const filterCategory = filter.category || category;\n    const filterQuery = filter.query || query;\n    const filterRating = filter.rating || rating;\n    const filterPrice = filter.price || price;\n    const sortOrder = filter.order || order;\n    return `/search?category=${filterCategory}&query=${filterQuery}&price=${filterPrice}&rating=${filterRating}&order=${sortOrder}&page=${filterPage}`;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Search Events\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 3,\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Department\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                className: 'all' === category ? 'text-bold' : '',\n                to: getFilterUrl({\n                  category: 'all'\n                }),\n                children: \"Any\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 15\n            }, this), categories.map(c => /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                className: c === category ? 'text-bold' : '',\n                to: getFilterUrl({\n                  category: c\n                }),\n                children: c\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 19\n              }, this)\n            }, c, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 17\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Price\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                className: 'all' === price ? 'text-bold' : '',\n                to: getFilterUrl({\n                  price: 'all'\n                }),\n                children: \"Any\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 15\n            }, this), prices.map(p => /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                to: getFilterUrl({\n                  price: p.value\n                }),\n                className: p.value === price ? 'text-bold' : '',\n                children: p.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 19\n              }, this)\n            }, p.value, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 17\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 9,\n        children: loading ? /*#__PURE__*/_jsxDEV(LoadingBox, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 13\n        }, this) : error ? /*#__PURE__*/_jsxDEV(MessageBox, {\n          variant: \"danger\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Row, {\n            className: \"justify-content-between mb-3\",\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              md: 6,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [countEvents === 0 ? 'No' : countEvents, \" Results\", query !== 'all' && ' : ' + query, category !== 'all' && ' : ' + category, price !== 'all' && ' : Price ' + price, query !== 'all' || category !== 'all' || price !== 'all' ? /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"light\",\n                  onClick: () => navigate('/search'),\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"fas fa-times-circle\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 206,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 202,\n                  columnNumber: 23\n                }, this) : null]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              className: \"text-end\",\n              children: [\"Sort by\", ' ', /*#__PURE__*/_jsxDEV(\"select\", {\n                value: order,\n                onChange: e => {\n                  navigate(getFilterUrl({\n                    order: e.target.value\n                  }));\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 15\n          }, this), events.length === 0 && /*#__PURE__*/_jsxDEV(MessageBox, {\n            children: \"Nu s-a gasit nici un\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            children: events.map(event => /*#__PURE__*/_jsxDEV(Col, {\n              sm: 6,\n              lg: 4,\n              className: \"mb-3\",\n              children: /*#__PURE__*/_jsxDEV(Event, {\n                event: event\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 21\n              }, this)\n            }, event._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [...Array(pages).keys()].map(x => /*#__PURE__*/_jsxDEV(LinkContainer, {\n              className: \"mx-1\",\n              to: getFilterUrl({\n                page: x + 1\n              }),\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                className: Number(page) === x + 1 ? 'text-bold' : '',\n                variant: \"light\",\n                children: x + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 21\n              }, this)\n            }, x + 1, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n}\n\n_s(SearchScreen, \"xI2TjYbVrS7wEN44xgIpdUoU6wI=\", false, function () {\n  return [useNavigate, useLocation];\n});\n\n_c = SearchScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"SearchScreen\");","map":{"version":3,"sources":["D:/ATTEMPT/amazona/frontend/src/screens/SearchScreen.js"],"names":["React","useEffect","useReducer","useState","Link","useNavigate","useLocation","axios","toast","getError","Helmet","Row","Col","Rating","LoadingBox","MessageBox","Button","Event","LinkContainer","reducer","state","action","type","loading","events","payload","page","pages","countEvents","error","prices","name","value","ratings","rating","SearchScreen","navigate","search","sp","URLSearchParams","category","get","query","price","order","dispatch","fetchData","data","err","categories","setCategories","fetchCategories","getFilterUrl","filter","filterPage","filterCategory","filterQuery","filterRating","filterPrice","sortOrder","map","c","p","e","target","length","event","_id","Array","keys","x","Number"],"mappings":"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","sourcesContent":["import React, { useEffect, useReducer, useState } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { getError } from '../utils';\nimport { Helmet } from 'react-helmet-async';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Rating from '../components/Rating';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nimport Button from 'react-bootstrap/Button';\nimport Event from '../components/Event';\nimport LinkContainer from 'react-router-bootstrap/LinkContainer';\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'FETCH_REQUEST':\n      return { ...state, loading: true };\n    case 'FETCH_SUCCESS':\n      return {\n        ...state,\n        events: action.payload.events,\n        page: action.payload.page,\n        pages: action.payload.pages,\n        countEvents: action.payload.countEvents,\n        loading: false,\n      };\n    case 'FETCH_FAIL':\n      return { ...state, loading: false, error: action.payload };\n\n    default:\n      return state;\n  }\n};\n\nconst prices = [\n  {\n    name: '$1 to $50',\n    value: '1-50',\n  },\n  {\n    name: '$51 to $200',\n    value: '51-200',\n  },\n  {\n    name: '$201 to $1000',\n    value: '201-1000',\n  },\n];\n\nexport const ratings = [\n  {\n    name: '4stars & up',\n    rating: 4,\n  },\n\n  {\n    name: '3stars & up',\n    rating: 3,\n  },\n\n  {\n    name: '2stars & up',\n    rating: 2,\n  },\n\n  {\n    name: '1stars & up',\n    rating: 1,\n  },\n];\n\nexport default function SearchScreen() {\n  const navigate = useNavigate();\n  const { search } = useLocation();\n  const sp = new URLSearchParams(search); // /search?category=Shirts\n  const category = sp.get('category') || 'all';\n  const query = sp.get('query') || 'all';\n  const price = sp.get('price') || 'all';\n  const rating = sp.get('rating') || 'all';\n  const order = sp.get('order') || 'newest';\n  const page = sp.get('page') || 1;\n\n  const [{ loading, error, events, pages, countEvents }, dispatch] =\n    useReducer(reducer, {\n      loading: true,\n      error: '',\n    });\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const { data } = await axios.get(\n          `/api/events/search?page=${page}&query=${query}&category=${category}&price=${price}&rating=${rating}&order=${order}`\n        );\n        dispatch({ type: 'FETCH_SUCCESS', payload: data });\n      } catch (err) {\n        dispatch({\n          type: 'FETCH_FAIL',\n          payload: getError(error),\n        });\n      }\n    };\n    fetchData();\n  }, [category, error, order, page, price, query, rating]);\n\n  const [categories, setCategories] = useState([]);\n  useEffect(() => {\n    const fetchCategories = async () => {\n      try {\n        const { data } = await axios.get(`/api/events/categories`);\n        setCategories(data);\n      } catch (err) {\n        toast.error(getError(err));\n      }\n    };\n    fetchCategories();\n  }, [dispatch]);\n\n  const getFilterUrl = (filter) => {\n    const filterPage = filter.page || page;\n    const filterCategory = filter.category || category;\n    const filterQuery = filter.query || query;\n    const filterRating = filter.rating || rating;\n    const filterPrice = filter.price || price;\n    const sortOrder = filter.order || order;\n    return `/search?category=${filterCategory}&query=${filterQuery}&price=${filterPrice}&rating=${filterRating}&order=${sortOrder}&page=${filterPage}`;\n  };\n  return (\n    <div>\n      <Helmet>\n        <title>Search Events</title>\n      </Helmet>\n      <Row>\n        <Col md={3}>\n          <h3>Department</h3>\n          <div>\n            <ul>\n              <li>\n                <Link\n                  className={'all' === category ? 'text-bold' : ''}\n                  to={getFilterUrl({ category: 'all' })}\n                >\n                  Any\n                </Link>\n              </li>\n              {categories.map((c) => (\n                <li key={c}>\n                  <Link\n                    className={c === category ? 'text-bold' : ''}\n                    to={getFilterUrl({ category: c })}\n                  >\n                    {c}\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          </div>\n          <div>\n            <h3>Price</h3>\n            <ul>\n              <li>\n                <Link\n                  className={'all' === price ? 'text-bold' : ''}\n                  to={getFilterUrl({ price: 'all' })}\n                >\n                  Any\n                </Link>\n              </li>\n              {prices.map((p) => (\n                <li key={p.value}>\n                  <Link\n                    to={getFilterUrl({ price: p.value })}\n                    className={p.value === price ? 'text-bold' : ''}\n                  >\n                    {p.name}\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          </div>\n        \n        </Col>\n        <Col md={9}>\n          {loading ? (\n            <LoadingBox></LoadingBox>\n          ) : error ? (\n            <MessageBox variant=\"danger\">{error}</MessageBox>\n          ) : (\n            <>\n              <Row className=\"justify-content-between mb-3\">\n                <Col md={6}>\n                  <div>\n                    {countEvents === 0 ? 'No' : countEvents} Results\n                    {query !== 'all' && ' : ' + query}\n                    {category !== 'all' && ' : ' + category}\n                    {price !== 'all' && ' : Price ' + price}\n                    {query !== 'all' ||\n                    category !== 'all' ||\n                    price !== 'all' ? (\n                      <Button\n                        variant=\"light\"\n                        onClick={() => navigate('/search')}\n                      >\n                        <i className=\"fas fa-times-circle\"></i>\n                      </Button>\n                    ) : null}\n                  </div>\n                </Col>\n                <Col className=\"text-end\">\n                  Sort by{' '}\n                  <select\n                    value={order}\n                    onChange={(e) => {\n                      navigate(getFilterUrl({ order: e.target.value }));\n                    }}\n                  >\n                  </select>\n                </Col>\n              </Row>\n              {events.length === 0 && (\n                <MessageBox>Nu s-a gasit nici un</MessageBox>\n              )}\n\n              <Row>\n                {events.map((event) => (\n                  <Col sm={6} lg={4} className=\"mb-3\" key={event._id}>\n                    <Event event={event}></Event>\n                  </Col>\n                ))}\n              </Row>\n\n              <div>\n                {[...Array(pages).keys()].map((x) => (\n                  <LinkContainer\n                    key={x + 1}\n                    className=\"mx-1\"\n                    to={getFilterUrl({ page: x + 1 })}\n                  >\n                    <Button\n                      className={Number(page) === x + 1 ? 'text-bold' : ''}\n                      variant=\"light\"\n                    >\n                      {x + 1}\n                    </Button>\n                  </LinkContainer>\n                ))}\n              </div>\n            </>\n          )}\n        </Col>\n      </Row>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}